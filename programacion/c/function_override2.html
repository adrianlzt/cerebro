<!DOCTYPE html>
<!-- saved from url=(0198)https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw -->
<html lang="es-x-mtfrom-en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(d){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_","_wtsrt",
d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><script src="./function_override2_files/translate_c.js"></script><script>_intlStrings._originalText = "Texto en español traducido automáticamente:";_intlStrings._interfaceDirection="ltr";_intlStrings._interfaceAlign="left";_intlStrings._langpair="en|es";_intlStrings._feedbackUrl="https://translate.google.com/translate_suggestion";_intlStrings._currentBy="Traducción actual del %1$s de %2$s";_intlStrings._unknown="desconocido";_intlStrings._suggestTranslation="Proponer una traducción mejor"  ;_intlStrings._submit="Enviar";_intlStrings._suggestThanks="Gracias por proponer una traducción al Traductor de Google.";_intlStrings._reverse=true;_intlStrings._staticContentPath="https://www.gstatic.com/translate/infowindow/";</script><style type="text/css">.google-src-text {display: none !important} .google-src-active-text {display: block!important;color:black!important; font-size:12px!important;font-family:arial,sans-serif!important}.google-src-active-text a {font-size:12px!important}.google-src-active-text a:link {color:#00c!important;text-decoration:underline!important}.google-src-active-text a:visited {color:purple!important;text-decoration:underline!important}.google-src-active-text a:active {color:red!important;text-decoration:underline!important}</style><meta http-equiv="X-Translated-By" content="Google"><link href="http://nairobi-embedded.org/elf_ld_preload.html" hreflang="en" rel="alternate machine-translated-from"><!--<base href="http://nairobi-embedded.org/elf_ld_preload.html">--><base href="."><!-- meta --><meta charset="utf-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1" name="viewport"><!-- window title --><title> Interposing Library Functions via &lt;/head&gt;&lt;body&gt;&lt;iframe src="https://translate.google.es/translate_un?anno=2&amp;depth=1&amp;hl=es&amp;rurl=translate.google.es&amp;sl=en&amp;tl=es&amp;u=http://nairobi-embedded.org/elf_ld_preload.html&amp;lang=en&amp;usg=ALkJrhj1-jKn3L_mxWMPJH7TmfqXUT-YkQ" width=0 height=0 frameborder=0 style="width:0px;height:0px;border:0px;display:none;"&gt;&lt;/iframe&gt;&lt;code&gt;LD_PRELOAD&lt;/code&gt; | nairobi-embedded </title><!-- css styles --><link rel="stylesheet" href="./function_override2_files/translate_c"></head><body><header id="top" class="navbar navbar-inverse navbar-fixed-top" role="banner"><div class="container"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class="navbar-brand" href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/&usg=ALkJrhgDU0da55J21CZzfmkE2-zNLn5G5w">incrustado en Nairobi</a></span> <a class="navbar-brand" href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/&usg=ALkJrhgDU0da55J21CZzfmkE2-zNLn5G5w">nairobi-embedded</a></span> <button class="navbar-toggle" data-target=".bs-navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only"></span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button> <nav class="collapse navbar-collapse bs-navbar-collapse" data-target=".nav-collapse" role="navigation"><ul class="nav navbar-nav"><!-- list categories on the nav bar --><!-- "toolchains", "linux" and "platforms" appear first --><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/gnulinux-toolchain-sw-dev.html&usg=ALkJrhhMdMGrXVy6bqCsM1v2MJ1rB9HeLg">GNU / Linux Toolchain y S / W Dev</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/gnulinux-toolchain-sw-dev.html&usg=ALkJrhhMdMGrXVy6bqCsM1v2MJ1rB9HeLg">GNU/Linux Toolchain &amp; S/W Dev</a></span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/linux.html&usg=ALkJrhjRZtE732VflssuX3kBOsKc3rnFhQ">Linux</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/linux.html&usg=ALkJrhjRZtE732VflssuX3kBOsKc3rnFhQ">Linux</a></span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/platforms.html&usg=ALkJrhi66HHWHz4q8g4wyuS__NWrvopBjA">Plataformas</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/platforms.html&usg=ALkJrhi66HHWHz4q8g4wyuS__NWrvopBjA">Platforms</a></span> </li><!-- "category index" appears next to the right --><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/index.html&usg=ALkJrhgwjGSsmsiq0MMaaw2X4I8y2lq8Ng">Índice de Categoría</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/index.html&usg=ALkJrhgwjGSsmsiq0MMaaw2X4I8y2lq8Ng">Category Index</a></span> </li><!-- "about" appears last (to the right) --><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/about.html&usg=ALkJrhjuLETCcgQHoUM1r6gV4lRrGKOkKA">Acerca de</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/about.html&usg=ALkJrhjuLETCcgQHoUM1r6gV4lRrGKOkKA">About</a></span> </li></ul></nav></div></header><!-- page "meat" --><div class="container-fluid"><!-- allow children to disable sitename from appearing on their content--><!-- allow children to define their own content --><div class="article"><div class="page-header"><h1> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Interponiendo Funciones Biblioteca vía <code>LD_PRELOAD</code></span> Interposing Library Functions via <code>LD_PRELOAD</code></span> </h1></div><!-- no author metadata for "special" categories --><div class="well small"><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><b>Autor:</b> <a class="url fn" href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/author/siro-mugabi.html&usg=ALkJrhie-1BYkoJ6HwsZr0QcPeLJZJzzhw"><i>Siro Mugabi</i></a></span> <b>Author:</b> <a class="url fn" href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/author/siro-mugabi.html&usg=ALkJrhie-1BYkoJ6HwsZr0QcPeLJZJzzhw"><i>Siro Mugabi</i></a></span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><b>Categoría:</b> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/elf-exercises.html&usg=ALkJrhiYKxrJGnT1XjyJksEtPoGKdIjjeQ">Ejercicios ELF</a></span> <b>Category:</b> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/category/elf-exercises.html&usg=ALkJrhiYKxrJGnT1XjyJksEtPoGKdIjjeQ">ELF Exercises</a></span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><b>Resumen:</b></span> <b>Summary:</b></span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Un ejemplo sencillo de anular las funciones definidas en otras bibliotecas compartidas a través <code>LD_PRELOAD</code></span> A simple example on overriding functions defined in other shared libraries via <code>LD_PRELOAD</code> .</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Este material es una extensión de la <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_shared_libraries.html&usg=ALkJrhjCMvmDt4dNTYlDxeyJWVqf0YJX9w"><em>construcción y uso de bibliotecas compartidas</em></a> tutorial.</span> This material is an extension of the <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_shared_libraries.html&usg=ALkJrhjCMvmDt4dNTYlDxeyJWVqf0YJX9w"><em>Building and Using Shared Libraries</em></a> tutorial.</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Se utilizó Ubuntu 12.04 AMD64 cadena de herramientas.</span> Ubuntu 12.04 AMD64 toolchain was used.</span> </p><p></p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><i>Etiquetas: <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/tag/elf-support.html&usg=ALkJrhiaXg5yz5aOQqvcrxrsEYrOm-6-fQ">apoyo elfo</a> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/tag/exercises.html&usg=ALkJrhg-5BOojxxPff1qRi26DkPAHXVBkw">ejerce</a> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/tag/libraries.html&usg=ALkJrhiqkzViDo8Ks0Lpn7SbDJjD0KCUSQ">bibliotecas</a></i></span> <i>Tags: <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/tag/elf-support.html&usg=ALkJrhiaXg5yz5aOQqvcrxrsEYrOm-6-fQ">elf support</a> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/tag/exercises.html&usg=ALkJrhg-5BOojxxPff1qRi26DkPAHXVBkw">exercises</a> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/tag/libraries.html&usg=ALkJrhiqkzViDo8Ks0Lpn7SbDJjD0KCUSQ">libraries</a></i></span> </div><div><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Tabla de contenidos</span> Table Of Contents</span> </h2><div class="toc"><ul><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#background">Fondo</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#background">Background</a></span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#basic-example">Ejemplo básico</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#basic-example">Basic Example</a></span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#interposing-printf3-example">Interponiendo <code>printf(3)</code> Ejemplo</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#interposing-printf3-example">Interposing <code>printf(3)</code> Example</a></span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#also-see">Vea también</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#also-see">Also See</a></span> </li><li> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#footnotes">Notas al pie</a></span> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#footnotes">Footnotes</a></span> </li></ul></div><h2 id="background"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Fondo</span> Background</span> </h2><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">De <code>ld.so(8)</code></span> From <code>ld.so(8)</code> :</span> </p><pre> <code>LD_PRELOAD A whitespace-separated list of additional, user-specified, ELF shared libraries to be loaded before all others. This can be used to selectively override functions in other shared libraries. For setuid/setgid ELF binaries, only libraries in the standard search directories that are also setgid will be loaded.</code> </pre><h2 id="basic-example"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Ejemplo básico</span> Basic Example</span> </h2><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Construir el siguiente <em>hola</em> biblioteca compartida <em>mundo.</em></span> Build the following <em>hello world</em> shared library.</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Para simplificar la ilustración, el nombre de la biblioteca y <em>soname</em> están establecidos en el nombre enlazador:</span> To simplify illustration, the library name and <em>soname</em> are both set to the linker name:</span> </p><pre> <code>$ cat libfoo.c #include &lt;stdio.h&gt; void lfunc(void) { puts("libfoo"); } $ gcc -Wall -O2 libfoo.c -fPIC -Wl,-soname=libfoo.so -o libfoo.so -shared</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Ahora construir la siguiente <em>hola programa</em> mundial para la prueba en contra de la biblioteca:</span> Now build the following <em>hello world</em> program for test against the library:</span> </p><pre> <code>$ cat prog.c extern void lfunc(void); int main(void) { lfunc(); return 0; } $ gcc -Wall -O2 prog.c -L. -lfoo -Wl,-rpath=$PWD</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><em>donde el</em> <code>-Wl,-rpath=$PWD</code> opción del vinculador se utiliza para evitar la necesidad de tener que especificar <code>LD_LIBRARY_PATH=$PWD</code> durante el lanzamiento del programa, es decir:</span> <em>where</em> the <code>-Wl,-rpath=$PWD</code> linker option is used to avoid the need of having to specify <code>LD_LIBRARY_PATH=$PWD</code> during program launch, ie:</span> </p><pre> <code>$ ./a.out libfoo</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Tenga en cuenta que <code>ld(1)</code> registra las bibliotecas que necesitan los <code>a.out</code> en los <code>DT_NEEDED</code> entradas de su sección dinámica:</span> Note that <code>ld(1)</code> records the libraries needed by <code>a.out</code> in the <code>DT_NEEDED</code> entries of its dynamic section:</span> </p><pre> <code>$ readelf -d a.out | grep NEEDED 0x0000000000000001 (NEEDED) Shared library: [libfoo.so] 0x0000000000000001 (NEEDED) Shared library: [libc.so.6]</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Ahora, cree el archivo de la biblioteca después de que exporta una función con un nombre idéntico, <code>lfunc()</code> como <code>libfoo.so</code> hace:</span> Now, create the following library file that exports a function with an identical name, <code>lfunc()</code> , as <code>libfoo.so</code> does:</span> </p><pre> <code>$ cat libbar.c #include &lt;stdio.h&gt; void lfunc(void) { puts("libbar"); } $ gcc -Wall -O2 libbar.c -fPIC -Wl,-soname=libbar.so -o libbar.so -shared</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Pre-carga <code>libbar.so</code> antes de cualquier otra biblioteca necesarios ahora harán que el enlazador dinámico para satisfacer las referencias a <code>lfunc()</code> de <code>libbar.so</code> lugar de <code>libfoo.so</code></span> Pre-loading <code>libbar.so</code> before any other needed libraries will now cause the dynamic linker to satisfy references to <code>lfunc()</code> from <code>libbar.so</code> rather than <code>libfoo.so</code> :</span> </p><pre> <code>$ LD_PRELOAD=libbar.so ./a.out libbar</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Una vez más, aunque <code>a.out</code> nunca se construyó contra <code>libbar.so</code> fue posible a invadir su llamamiento a <code>lfunc()</code> en <code>libfoo.so</code> es decir <code>libbar.so</code> no será necesario registrar en <code>a.out</code> 's <code>DT_NEEDED</code> entradas para <code>LD_PRELOAD</code> para trabajar .</span> Again, although <code>a.out</code> was never built against <code>libbar.so</code> , it was possible to overrun its call to <code>lfunc()</code> in <code>libfoo.so</code> , ie <code>libbar.so</code> need not be recorded in <code>a.out</code> 's <code>DT_NEEDED</code> entries for <code>LD_PRELOAD</code> to work.</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Por último, para ver el orden en el que las bibliotecas se cargan, y la manera en que se lleva a cabo el símbolo de búsqueda y obligatorias:</span> Finally, to view the order in which libraries get loaded, and the manner in which symbol lookup and binding is performed:</span> </p><pre> <code>$ LD_DEBUG=all LD_PRELOAD=libbar.so ./a.out 2&gt;&amp;1 | egrep '(trying.*bar|trying.*foo|symbol.*lfunc|binding.*lfunc)' 26024: trying file=/tmp/tls/x86_64/libbar.so 26024: trying file=/tmp/tls/libbar.so 26024: trying file=/tmp/x86_64/libbar.so 26024: trying file=/tmp/libbar.so 26024: trying file=/tmp/libfoo.so 26024: symbol=lfunc; lookup in file=./a.out [0] 26024: symbol=lfunc; lookup in file=/tmp/libbar.so [0] 26024: binding file ./a.out [0] to /tmp/libbar.so [0]: normal symbol `lfunc'</code> </pre><h2 id="interposing-printf3-example"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Interponiendo <code>printf(3)</code> Ejemplo</span> Interposing <code>printf(3)</code> Example</span> </h2><p></p><center> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><em>Este ejemplo se incluye a modo de ilustración</em></span> <em>This example is included for illustration purposes only</em></span> </center><p></p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Considere el siguiente programa de demostración:</span> Consider the following demo program:</span> </p><pre> <code>$ cat print_args.c #include &lt;stdio.h&gt; int main(int argc, char **argv) { printf("%s received %d args\n", argv[0], argc); puts("This program works fine.\n"); return 0; } $ gcc -Wall -O2 print_args.c -o print_args $ strip print_args $ ./print_args ./print_args received 1 args This program works fine.</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Ahora, la realización de:</span> Now, performing:</span> </p><pre> <code>$ readelf --dyn-syms print_args Symbol table '.dynsym' contains 5 entries: Num: Value Size Type Bind Vis Ndx Name 0: 0000000000000000 0 NOTYPE LOCAL DEFAULT UND 1: 0000000000000000 0 FUNC GLOBAL DEFAULT UND puts@GLIBC_2.2.5 (2) 2: 0000000000000000 0 FUNC GLOBAL DEFAULT UND __libc_start_main@GLIBC_2.2.5 (2) 3: 0000000000000000 0 NOTYPE WEAK DEFAULT UND __gmon_start__ 4: 0000000000000000 0 FUNC GLOBAL DEFAULT UND __printf_chk@GLIBC_2.3.4 (3)</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">revela que el programa invoca una <em>glibc</em> versionado <code>printf</code></span> reveals that the program invokes a <em>glibc</em> versioned <code>printf</code> .</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">El objetivo es que aquí es efectuar interposición función selectiva de tal manera que la llamada a este <em>glibc</em> versionado <code>printf</code> puntos para una implementación en una biblioteca privada sobre carga del programa.</span> The objective is here is to effect selective function interposition such that the call to this <em>glibc</em> versioned <code>printf</code> points to an implementation in a private library upon program load.</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Tenga en cuenta que el enfoque de la interposición función selectiva descrito aquí se aplica a los binarios que emplean vinculación dinámica en tiempo de carga es decir, sin <code>dlopen(3)</code> las interfaces para la función (s) que se interpone.</span> Note that the approach to selective function interposition described here applies to binaries employing load-time dynamic linking ie no <code>dlopen(3)</code> interfaces for the function(s) to be interposed.</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Ahora, considere la siguiente versión de la biblioteca privada que exportar una <em>glibc</em> versionado "falso" <code>printf</code> de interposición.</span> Now, consider the following private library version that will export a "fake" <em>glibc</em> versioned <code>printf</code> for interposition.</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Para simplificar la ilustración, este impostor de un <code>printf(3)</code> aplicación simplemente imprime una cadena constante, ignorando por completo los argumentos de cadena de formato y de longitud variable se le pasan:</span> To simplify illustration, this imposter of a <code>printf(3)</code> implementation simply prints out a string constant, completely ignoring the format string and variable-length arguments passed to it:</span> </p><pre> <code>$ cat libfakeprintf.c #include &lt;unistd.h&gt; int __printf__(const char *format, ...) { return write(1, "heheh...\n", 9); } asm(".symver __printf__, __printf_chk@GLIBC_2.3.4"); $ cat fakeprintf.map GLIBC_2.3 { global: __printf__; local: *; }; GLIBC_2.3.4 { global: __printf__; }GLIBC_2.3; $ gcc -shared -o libfakeprintf.so libfakeprintf.c -fPIC \ -Wl,-soname=libfakeprintf.so -Wl,--version-script=fakeprintf.map $ readelf --dyn-syms libfakeprintf.so | grep printf 8: 00000000000005ec 113 FUNC GLOBAL DEFAULT 12 __printf_chk@GLIBC_2.3.4 9: 00000000000005ec 113 FUNC GLOBAL DEFAULT 12 __printf__@@GLIBC_2.3</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">El <code>.symver</code> ensamblador pseudo-op y <code>fakeprintf.map</code> <em>guión versión</em> se usan aquí para efectuar símbolo de versiones información correspondiente a lo que el <code>print_args</code> binaria espera <sup><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#fn1" id="ref1">1.</a></sup></span> The <code>.symver</code> assembler pseudo-op and <code>fakeprintf.map</code> <em>version script</em> are used here to effect symbol versioning info corresponding to what the <code>print_args</code> binary expects <sup><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#fn1" id="ref1">1</a></sup> .</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Prueba:</span> Test:</span> </p><pre> <code>$ LD_PRELOAD=./libfakeprintf.so ./print_args heheh... This program works fine.</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A modo de ejercicio, interponer la llamada a <code>puts(3)</code></span> As an excercise, interpose the call to <code>puts(3)</code> .</span> </p><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">El siguiente comando se puede utilizar para ver el símbolo de búsqueda y obligatorias:</span> The following command may be used to view symbol lookup and binding:</span> </p><pre> <code>$ LD_DEBUG=all LD_PRELOAD=./libfakeprintf.so ./print_args 2&gt;&amp;1 | egrep '(trying.*fakeprintf|symbol.*__printf_chk|binding.*__printf_chk)' 29501: symbol=__printf_chk; lookup in file=./print_args [0] 29501: symbol=__printf_chk; lookup in file=./libfakeprintf.so [0] 29501: binding file ./print_args [0] to ./libfakeprintf.so [0]: normal symbol `__printf_chk' [GLIBC_2.3.4]</code> </pre><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Tenga en cuenta que desde que se especifica una ruta de nombre de la biblioteca calificado contra <code>LD_PRELOAD</code> <code>ld-linux.so</code> no tuvo que realizar búsquedas de <code>libfakeprintf.so</code> por ejemplo:</span> Notice that since a path qualified library name was specified against <code>LD_PRELOAD</code> , <code>ld-linux.so</code> didn't have to perform searches for <code>libfakeprintf.so</code> , for instance:</span> </p><pre> <code>$ LD_DEBUG=all LD_PRELOAD=libfakeprintf.so [...] 29504: trying file=/lib/x86_64-linux-gnu/tls/x86_64/libfakeprintf.so 29504: trying file=/lib/x86_64-linux-gnu/tls/libfakeprintf.so 29504: trying file=/lib/x86_64-linux-gnu/x86_64/libfakeprintf.so 29504: trying file=/lib/x86_64-linux-gnu/libfakeprintf.so [...]</code> </pre><h2 id="also-see"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><em>Vea también</em></span> <em>Also See</em></span> </h2><ul><li><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><em><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_interposing_lib_funcs_with_ld.html&usg=ALkJrhhkMazyz-Df9MHHUDl5-ZoCFPpvlQ">Interponiendo Funciones Biblioteca con <code>ld(1)</code></a></em></span> <em><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_interposing_lib_funcs_with_ld.html&usg=ALkJrhhkMazyz-Df9MHHUDl5-ZoCFPpvlQ">Interposing Library Functions with <code>ld(1)</code></a></em></span> </p></li><li><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><em><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_library_path_n_lfunc_override.html&usg=ALkJrhgQvKtByQYltDfIQWGZe00WYrldJg">Biblioteca defecto primordial a través de <code>LD_LIBRARY_PATH</code></a></em></span> <em><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_library_path_n_lfunc_override.html&usg=ALkJrhgQvKtByQYltDfIQWGZe00WYrldJg">Overriding Default Library via <code>LD_LIBRARY_PATH</code></a></em></span> </p></li></ul><h2 id="footnotes"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Notas al pie</span> Footnotes</span> </h2><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><sup id="fn1">1. Vea <em>Cómo escribir Compartidos Bibliotecas,</em> Ulrich Drepper, de información <em>adecuada</em> sobre el uso de <code>.symver</code> versión guiones, etc. <i><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#ref1" title="Return to text segment">[volver]</a></i></sup></span> <sup id="fn1">1. See <em>How To Write Shared Libraries</em> , Ulrich Drepper, for <em>proper</em> info on using <code>.symver</code> , version scripts, etc. <i><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://nairobi-embedded.org/elf_ld_preload.html&usg=ALkJrhid2k04d2DjNHNySdEdzLKgj1CqXw#ref1" title="Return to text segment">[go back]</a></i></sup></span> </p></div><!-- "404" for "url/{author|img|theme}/index.html" --><!-- list all categories for  "url/category/index.html" --><!-- footer --><footer><hr><div id="footer"><table><tbody><tr><td nowrap="nowrap" align="left" width="1%"><div id="copylefticon"> <a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://www.gnu.org/licenses/old-licenses/fdl-1.2.txt&usg=ALkJrhghY28wzTOG4paCK03mbrj-Jfl_UQ"><img alt="GFDL v1.2" src="http://nairobi-embedded.org/img/gnu-fdl.png"></a> </div></td><td align="center"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">El contenido está disponible bajo los términos <i><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://www.gnu.org/licenses/old-licenses/fdl-1.2.txt&usg=ALkJrhghY28wzTOG4paCK03mbrj-Jfl_UQ">de GNU Free Documentation License 1.2</a></i></span> Content is available under <i><a href="https://translate.googleusercontent.com/translate_c?anno=2&depth=1&hl=es&rurl=translate.google.es&sl=en&tl=es&u=http://www.gnu.org/licenses/old-licenses/fdl-1.2.txt&usg=ALkJrhghY28wzTOG4paCK03mbrj-Jfl_UQ">GNU Free Documentation License 1.2</a></i></span> </td><td align="right"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">© nairobi embebido</span> © nairobi-embedded</span> </td></tr></tbody></table></div></footer></div>
<script>_addload(function(){_setupIW();_csi('en','es','http://nairobi-embedded.org/elf_ld_preload.html');});</script></div></body></html>